<!DOCTYPE html>
<html>
<head>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { height: 100%; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    #chat-container { display: flex; flex-direction: column; height: 100%; }
    #chat-messages { flex: 1; overflow-y: auto; padding: 15px; background: #f7f7f8; }
    .message { margin-bottom: 15px; }
    .message.user { text-align: right; }
    .message-text { display: inline-block; max-width: 80%; padding: 10px 15px; border-radius: 12px; }
    .message.user .message-text { background: #007aff; color: white; }
    .message.assistant .message-text { background: white; border: 1px solid #e5e5e5; }
    #chat-input-area { padding: 15px; border-top: 1px solid #e5e5e5; background: white; }
    #chat-input { width: 100%; padding: 10px; border: 1px solid #d1d1d1; border-radius: 8px; resize: none; }
    #send-btn { margin-top: 10px; padding: 8px 20px; background: #007aff; color: white; border: none; border-radius: 6px; cursor: pointer; }
    #send-btn:hover { background: #0056b3; }
  </style>
</head>
<body>
  <div id="chat-container">
    <div id="chat-messages"></div>
    <div id="chat-input-area">
      <textarea id="chat-input" rows="2" placeholder="Type your message..."></textarea>
      <button id="send-btn">Send</button>
    </div>
  </div>
  <script>
    // Minimal chat UI
    const messagesEl = document.getElementById('chat-messages');
    const inputEl = document.getElementById('chat-input');
    const sendBtn = document.getElementById('send-btn');
    
    sendBtn.onclick = () => {
      const text = inputEl.value.trim();
      if (!text) return;
      
      // Add user message
      addMessage('user', text);
      inputEl.value = '';
      
      // Add thinking message
      const thinkingId = addMessage('assistant', 'Thinking...');
      
      // Call backend
      try {
        if (window.sendToLLM) {
          window.sendToLLM(text).then(response => {
            updateMessage(thinkingId, response);
          }).catch(err => {
            updateMessage(thinkingId, 'Error: ' + err.message);
          });
        } else {
          updateMessage(thinkingId, 'Backend not connected.');
        }
      } catch (err) {
        updateMessage(thinkingId, 'Error: ' + err.message);
      }
    };
    
    inputEl.onkeydown = (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendBtn.click();
      }
    };
    
    function addMessage(role, text) {
      const div = document.createElement('div');
      div.className = `message ${role}`;
      div.innerHTML = `<div class="message-text">${text}</div>`;
      messagesEl.appendChild(div);
      messagesEl.scrollTop = messagesEl.scrollHeight;
      return div;
    }
    
    function updateMessage(messageEl, text) {
      const textEl = messageEl.querySelector('.message-text');
      textEl.textContent = text;
    }
  </script>
</body>
</html>

